# SELinux Policy for Seccomp Security
# This policy manages secure computing mode (seccomp) for system security

module seccomp_security 1.0.0;

require {
    type auditd_t;
    type sshd_t;
    type sssd_t;
    type pam_t;
    type unconfined_t;
    type user_t;
    type staff_t;
    class seccomp { read write };
    class process signal;
    class file { read write getattr append create };
}

# Seccomp security types
type seccomp_config_t;
type seccomp_log_t;

# Allow audit daemon to use seccomp for secure computing
allow auditd_t self:seccomp { read write };

# Allow authentication services to use seccomp
allow sshd_t self:seccomp { read write };
allow sssd_t self:seccomp { read write };
allow pam_t self:seccomp { read write };

# Allow administrative users to configure seccomp
allow unconfined_t seccomp_config_t:file { read write getattr };
allow staff_t seccomp_config_t:file { read getattr };

# Allow seccomp logging
allow auditd_t seccomp_log_t:file { write append create getattr };
allow sshd_t seccomp_log_t:file { write append };
allow sssd_t seccomp_log_t:file { write append };
allow pam_t seccomp_log_t:file { write append };

# Deny regular users from seccomp operations
neverallow user_t self:seccomp { read write };
neverallow user_t seccomp_config_t:file { read write };
