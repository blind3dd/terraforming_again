# Terraform Operator Helm Values
replicaCount: {{ terraform_operator_replicas }}

image:
  repository: {{ terraform_operator_image_repository }}
  tag: {{ terraform_operator_image_tag }}
  pullPolicy: {{ terraform_operator_image_pull_policy }}

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  create: true
  annotations: {}
  name: {{ service_accounts.terraform_operator }}

rbac:
  create: {{ rbac_enabled }}

podAnnotations: {}

podSecurityContext:
  fsGroup: 2000

securityContext:
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  runAsUser: 1000

service:
  type: ClusterIP
  port: 80

ingress:
  enabled: false
  className: ""
  annotations: {}
  hosts:
    - host: terraform-operator.local
      paths:
        - path: /
          pathType: Prefix
  tls: []

resources:
  limits:
    cpu: {{ terraform_operator_cpu_limit }}
    memory: {{ terraform_operator_memory_limit }}
  requests:
    cpu: {{ terraform_operator_cpu_request }}
    memory: {{ terraform_operator_memory_request }}

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 100
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 80

nodeSelector: {}

tolerations: []

affinity: {}

# Terraform Operator specific configuration
terraform:
  version: "1.5.0"
  backend:
    type: "s3"
    config:
      bucket: "{{ terraform_state_bucket | default('terraform-state-bucket') }}"
      region: "{{ aws_region | default('us-west-2') }}"
      key: "terraform.tfstate"
      dynamodb_table: "{{ terraform_state_lock_table | default('terraform-state-lock') }}"

# Environment variables
env:
  - name: AWS_REGION
    value: "{{ aws_region | default('us-west-2') }}"
  - name: AWS_ACCESS_KEY_ID
    valueFrom:
      secretKeyRef:
        name: aws-credentials
        key: access-key-id
  - name: AWS_SECRET_ACCESS_KEY
    valueFrom:
      secretKeyRef:
        name: aws-credentials
        key: secret-access-key
