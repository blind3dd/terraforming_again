# Audit Rules for Authentication Events
# This file defines what authentication events to audit

# Configure audit log file locations
-w /var/log/audit.log -p wa -k audit_log
-w /var/log/secure -p wa -k secure_log

# SSHD Authentication Events
-a always,exit -F arch=b64 -S connect -F key=sshd_connect
-a always,exit -F arch=b64 -S accept -F key=sshd_accept
-a always,exit -F arch=b64 -S openat -F path=/etc/ssh/sshd_config -F key=sshd_config
-a always,exit -F arch=b64 -S openat -F path=/var/log/secure -F key=sshd_log

# SSSD Authentication Events
-a always,exit -F arch=b64 -S connect -F key=sssd_connect
-a always,exit -F arch=b64 -S openat -F path=/etc/sssd/sssd.conf -F key=sssd_config
-a always,exit -F arch=b64 -S openat -F path=/var/log/sssd -F key=sssd_log

# PAM Authentication Events
-a always,exit -F arch=b64 -S openat -F path=/etc/pam.d -F key=pam_config
-a always,exit -F arch=b64 -S openat -F path=/etc/shadow -F key=pam_shadow
-a always,exit -F arch=b64 -S openat -F path=/etc/passwd -F key=pam_passwd
-a always,exit -F arch=b64 -S openat -F path=/etc/group -F key=pam_group

# Login/Logout Events
-w /var/log/wtmp -p wa -k logins
-w /var/log/btmp -p wa -k failed_logins
-w /var/log/lastlog -p wa -k lastlog

# Sudo Events
-w /etc/sudoers -p wa -k sudoers
-w /etc/sudoers.d/ -p wa -k sudoers

# User Management Events
-w /etc/passwd -p wa -k passwd_changes
-w /etc/shadow -p wa -k shadow_changes
-w /etc/group -p wa -k group_changes
-w /etc/gshadow -p wa -k gshadow_changes

# Authentication Service Events
-w /etc/ssh/ -p wa -k ssh_config
-w /etc/sssd/ -p wa -k sssd_config
-w /etc/pam.d/ -p wa -k pam_config
